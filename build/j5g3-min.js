(function(n,q,k){var w="0.1",e,x,a,v,C,s,A,m,y,l,p,B,u,j,d,h,o,b,g=n.j5g3=new (function(){var E={version:w},D=this,F=function(){return d.getContext("2d")},f=function(G){g.Property.define(D.constructor,{canvas:null,backgroundStyle:"black",width:640,height:480});h(D,G);if(D._p.canvas===null){D._p.canvas=g.id("screen")}d=D._p.canvas;D.background=new l({fillStyle:D.backgroundStyle(),width:D.width(),height:D.height()});D.root=new a({width:D.width(),height:D.height()});d.width=D.width();d.height=D.height();d.addEventListener("click",D.onClick,false);G.start(g,q)};this.run=function(){setInterval(this.gameLoop,this._p.fps)};this.gameLoop=function(){b=F();D.background.draw();D.root.draw()};this.fps=function(G){if(G===k){return 1000/this._p.fps}this._p.fps=1000/G;return this};this.start=function(G){f(typeof(G)=="function"?{start:G}:G)};this.invalidate=function(){return this};this.id=function(G){return q.getElementById(G)}});x={Easing:{None:function(){},RegularOut:function(){return 0}}};m=function(f){return function(D){return D===k?this._p[f]:(this._p[f]=D,this.invalidate())}};m.get=function(D,f){return function(E){return D[f]}};m.define=function(E,D){for(var f in D){E.prototype[f]=m(f)}E.properties=D;return E};h=m.extend=function(F,E){F._p={};var D=F.constructor.properties,f;if(E){for(f in D){F._p[f]=E[f]||D[f]}}else{for(f in D){F._p[f]=D[f]}}return F._p};j={extend:function(D,f){for(var E in f){D[E]=f[E]}return D},inherit:function(D,f){for(var E in f){D[E]=D[E]||f[E]}return D},clone:function(D){var f={};for(var E in D){f[E]=D[E]}return f},Class:function(f,F,E,D){j.extend(f.prototype,new F);m.define(f,E);j.inherit(E,F.properties);j.extend(f.prototype,D);return f}};v=j.Class;o=j.getType=function(D){var f=typeof(D);if(f=="object"){if(D instanceof Array){return"array"}if(D instanceof HTMLElement){return"DOM"}if(D._p){return"j5g3"}}return f};s={Image:function(){b.drawImage(this._p.source,0,0)},Sprite:function(){var E=this.source(),f=this.width(),D=this.height();b.drawImage(E.image,E.x,E.y,E.w,E.h,0,0,f?f:E.w,D?D:E.h)},Container:function(){var D=this.frame();for(var f in D){D[f].draw(b)}},Text:function(){b.fillText(this.text(),0,0)}};v(C=function(f){this._p={};h(this,f);this._dirty=true},Object,{source:null,parent:null,x:0,y:0,width:null,height:null,rotation:0,scaleX:1,scaleY:1,alpha:1},{begin:function(){b.save();b.globalAlpha*=this.alpha();b.translate(this.x(),this.y());b.scale(this.scaleX(),this.scaleY());b.rotate(this.rotation())},end:function(){b.restore()},draw:function(){this.begin();this.paint();this.end()},invalidate:function(){this._dirty=true;return this},isDirty:function(){return this._dirty},align:function(D,f){switch(D){case"center":this.x(f.width()/2);break;case"left":this.x(0);break;case"right":this.x(f.width()-this.width());break;case"middle":this.y(f.height()/2);break}return this},collidesWith:function(G){var E=this.x()-G.x();var D=this.y()-G.y();var f=this.width();if(Math.abs(E)>f||Math.abs(D)>f){return false}var F=E*E+D*D;if(F>f*f){return false}return true},pos:function(f,D){this._p.x=f;this._p.y=D;this.invalidate();return this}});v(a=function(f){h(this,f);if(!this._p.frames){this._p.frames=[[]]}this._frame=0;this._playing=true},C,{frames:null},{frame:function(){z=this.frames()[this._frame];if(this._playing){this.nextFrame()}return z},totalFrames:function(){return this.frames().length},currentFrame:function(){return _frame},nextFrame:function(){this._frame=(this._frame<this.totalFrames()-1)?this._frame+1:0},paint:s.Container,stop:function(){this._playing=false},play:function(){this._playing=true},add:function(E){switch(o(E)){case"function":E=new e(E);break;case"string":E=new A({source:E});break;case"object":E=new A(E);break;case"array":for(var D in E){this.add(E[D])}return this}E.parent(this);var F=this.frames();F[F.length-1].push(E);return this},gotoFrame:function(f){this._frame=f;return this},gotoAndPlay:function(f){this.gotoFrame(f);this.play();return this},gotoAndStop:function(f){this.gotoFrame(f);this.stop();return this},alignChildren:function(E){var D=this.frame();for(var f in D){if(D[f].align){D[f].align(E,this)}}return this},animateTo:function(E,D,G){var F={};if(G===k){G=x.Easing.None}for(var f in E){F[f]=E}return function(){G(F,E,this._iframe)}}});v(A=function(f){switch(o(f)){case"string":case"DOM":f={source:f};break}h(this,f);if(this._p.source){this.source(this._p.source)}},C,{},{paint:s.Image,source:function(f){if(f){if(typeof(f)=="string"){this._p.source=new n.Image;this._p.source.src=f}else{this._p.source=f}if(this._p.width===null){this._p.width=this._p.source.width}if(this._p.height===null){this._p.height=this._p.source.height}this.invalidate();return this}return this._p.source}});v(y=function(D,f){if(typeof D!="object"){D={start:D,end:f}}h(this,D)},Object,{start:0,end:0},{to_a:function(){var E=this._p,D=E.start,f=[];for(;D<E.end;D++){f.push(D)}return f}});v(l=function(f){h(this,f)},C,{fillStyle:null},{paint:function(){if(this._p.fillStyle){b.fillStyle=this._p.fillStyle}b.fillRect(this._p.x,this._p.y,this._p.width,this._p.height)}});v(p=function(f){h(this,f)},C,{},{paint:s.Sprite});v(B=function(f){switch(o(f)){case"string":case"DOM":case"j5g3":f={source:f}}switch(o(f.source)){case"string":case"DOM":f.source=new A(f.source);break}if(f.width===k&&f.source){f.width=f.source.width()}if(f.height===k&&f.source){f.height=f.source.height()}var D=h(this,f);D.sprites=D.sprites||[]},Object,{width:0,height:0,source:null,sprites:k,cols:1,rows:1,type:"grid"},{clip:function(f){return this.clipArray(arguments)},clip_array:function(E){var f=this.sprites(),D=[];for(i=0;i<E.length;i++){D.push([f[E[i]]])}return new a({frames:D})},clip_range:function(f){return this.clipArray(f.to_a())},cut:function(D){var f=new p(o(D)=="array"?{source:{image:this.source().source(),x:D[0],y:D[1],w:D[2],h:D[3]}}:{source:{image:this.source().source(),x:D.x,y:D.y,w:D.w,h:D.h}});this._p.sprites.push(f);return f},grid:function(f,G){var F=this._p.sprites=[],D=this.width()/f,E=this.height()/G;r=0,c=0;for(;r<f;r++){for(;c<f;c++){F.push(new p({source:{image:this.source().source(),x:c*D,y:r*E,w:D,h:E}}))}}return this}});var t;v(u=function(f){if(typeof f=="string"){f={text:f}}h(this,f)},C,{text:"",fillStyle:"white",font:null},{begin:function(){t.apply(this,[b]);if(this._p.fillStyle){b.fillStyle=this._p.fillStyle}if(this._p.font){b.font=this._p.font}},paint:s.Text,width:function(){var f=d.getContext("2d");this.begin(f);var D=f.measureText(this.text());return D.width}});t=C.prototype.begin;e=function(f){this.draw=(typeof f=="function")?f:f.code;this.parent=function(){}};e.rotate=function(f){return function(){var D=f.rotation();f.rotation(D<6.1?D+0.1:0)}};var z=function(f){return function(D){return new f(D)}};g.Animate=x;g.Draw=s;g.Property=m;g.Util=j;g.Action=e;g.Clip=a;g.DisplayObject=C;g.Image=A;g.Range=y;g.Rect=l;g.Sprite=p;g.Spritesheet=B;g.Text=u;g.action=z(e);g.clip=z(a);g.image=z(A);g.range=z(y);g.rect=z(l);g.sprite=z(p);g.spritesheet=z(B);g.text=z(u)})(this,document);