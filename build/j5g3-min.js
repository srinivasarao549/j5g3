(function(p,t,l){var y="0.1",e,z,a,x,o,E,u,C,g,n,A,m,s,D,w,k,d,j,q,b,h=p.j5g3=new (function(){var G={version:y},F=this,H=function(){return b},f=function(I){h.Property.define(F.constructor,{canvas:null,backgroundStyle:"black",width:640,height:480});j(F,I);if(F._p.canvas===null){F._p.canvas=h.id("screen")}F._p.fps=31;d=F._p.canvas;F.background=new m({fillStyle:F.backgroundStyle(),width:F.width(),height:F.height()});F.root=new a({width:F.width(),height:F.height()});d.width=F.width();d.height=F.height();I.start(h,t)};this.run=function(){setInterval(this.gameLoop,this._p.fps)};this.gameLoop=function(){b=d.getContext("2d");F.background.draw();F.root.draw()};this.fps=function(I){if(I===l){return 1000/this._p.fps}this._p.fps=1000/I;return this};this.start=function(I){f(typeof(I)=="function"?{start:I}:I)};this.invalidate=function(){return this};this.id=function(I){return t.getElementById(I)}});z={Easing:{None:function(){},RegularOut:function(){return 0}}};o={Circle:function(f){var H=this.x()-f.x(),G=this.y()-f.y(),F=this.width();if(Math.abs(H)>F||Math.abs(G)>F){return false}var I=H*H+G*G;return(I<=F*F)},AABB:function(f){var G=this.x(),F=this.y(),I=f.x(),H=f.y();return(G+this.width()>=I&&G<=I+f.width())&&(F+this.height()>H&&F<=H+f.height())}};n=function(f){return function(F){return F===l?this._p[f]:(this._p[f]=F,this.invalidate())}};n.get=function(F,f){return function(G){return F[f]}};n.define=function(G,F){for(var f in F){G.prototype[f]=n(f)}G.properties=F;return G};j=n.extend=function(H,G){H._p={};var F=H.constructor.properties,f;if(G){for(f in F){H._p[f]=G[f]||F[f]}}else{for(f in F){H._p[f]=F[f]}}return H._p};k={extend:function(F,f){for(var G in f){F[G]=f[G]}return F},inherit:function(F,f){for(var G in f){F[G]=F[G]||f[G]}return F},clone:function(F){var f={};for(var G in F){f[G]=F[G]}return f},Class:function(f,H,G,F){k.extend(f.prototype,new H);n.define(f,G);k.inherit(G,H.properties);k.extend(f.prototype,F);return f}};x=k.Class;q=k.getType=function(F){var f=typeof(F);if(f=="object"){if(F instanceof Array){return"array"}if(F instanceof HTMLAudioElement){return"audio"}if(F instanceof HTMLElement){return"DOM"}if(F._p){return"j5g3"}}return f};u={Image:function(){b.drawImage(this._p.source,0,0)},Sprite:function(){var G=this.source(),f=this.width(),F=this.height();b.drawImage(G.image,G.x,G.y,G.w,G.h,0,0,f?f:G.w,F?F:G.h)},Container:function(){var F=this.frame();for(var f in F){F[f].draw(b)}},Text:function(){b.fillText(this.text(),0,0)}};x(E=function(f){j(this,f);this._dirty=true},Object,{source:null,parent:null,x:0,y:0,width:null,height:null,rotation:0,scaleX:1,scaleY:1,alpha:1},{begin:function(){b.save();b.globalAlpha*=this.alpha();b.translate(this.x(),this.y());b.scale(this.scaleX(),this.scaleY());b.rotate(this.rotation())},end:function(){b.restore()},draw:function(){this.begin();this.paint();this.end()},invalidate:function(){this._dirty=true;return this},isDirty:function(){return this._dirty},align:function(F,f){switch(F){case"center":this.x(f.width()/2);break;case"left":this.x(0);break;case"right":this.x(f.width()-this.width());break;case"middle":this.y(f.height()/2);break}return this},collides:o.Circle,pos:function(f,F){this._p.x=f;this._p.y=F;return this.invalidate()}});x(a=function(f){j(this,f);if(!this._p.frames){this._p.frames=[[]]}this._frame=0;this._playing=true},E,{frames:null},{frame:function(){B=this.frames()[this._frame];if(this._playing){this.nextFrame()}return B},totalFrames:function(){return this.frames().length},currentFrame:function(){return _frame},nextFrame:function(){this._frame=(this._frame<this.totalFrames()-1)?this._frame+1:0},paint:u.Container,stop:function(){this._playing=false},play:function(){this._playing=true},add:function(G){switch(q(G)){case"function":G=new e(G);break;case"string":G=new C({source:G});break;case"object":G=new C(G);break;case"array":for(var F in G){this.add(G[F])}return this;case"audio":G={parent:n("parent"),draw:function(){G.play()}};break}if(G.parent){G.parent(this)}var H=this.frames();H[H.length-1].push(G);return this},gotoFrame:function(f){this._frame=f;return this},gotoAndPlay:function(f){this.gotoFrame(f);this.play();return this},gotoAndStop:function(f){this.gotoFrame(f);this.stop();return this},alignChildren:function(G){var F=this.frame();for(var f in F){if(F[f].align){F[f].align(G,this)}}return this},animateTo:function(G,F,I){var H={};if(I===l){I=z.Easing.None}for(var f in G){H[f]=G}return function(){I(H,G,this._iframe)}}});x(C=function(f){switch(q(f)){case"string":case"DOM":f={source:f};break}j(this,f);if(this._p.source){this.source(this._p.source)}},E,{},{paint:u.Image,source:function(f){if(f){if(typeof(f)=="string"){this._p.source=new p.Image;this._p.source.src=f}else{this._p.source=f}if(this._p.width===null){this._p.width=this._p.source.width}if(this._p.height===null){this._p.height=this._p.source.height}this.invalidate();return this}return this._p.source}});x(A=function(F,f){if(typeof F!="object"){F={start:F,end:f}}j(this,F)},Object,{start:0,end:0},{to_a:function(){var G=this._p,F=G.start,f=[];for(;F<G.end;F++){f.push(F)}return f}});x(m=function(f){j(this,f)},E,{fillStyle:null},{paint:function(){if(this._p.fillStyle){b.fillStyle=this._p.fillStyle}b.fillRect(this._p.x,this._p.y,this._p.width,this._p.height)}});x(g=function(f){j(this,f)},Object,{obj:null,v:null,m:1},{draw:function(){var F=this._p.obj,f=this._p.v;F.x(F.x()+f[0]);F.y(F.y()+f[1])},force:function(I,H,F,J){var f=this._p.m,G=this._p.v;G[0]=(f*G[0]+I)/f;G[1]=(f*G[1]+H)/f;return this},impulse:function(){},invalidate:function(){}});x(s=function(f){j(this,f)},E,{},{paint:u.Sprite});x(D=function(f){switch(q(f)){case"string":case"DOM":case"j5g3":f={source:f}}switch(q(f.source)){case"string":case"DOM":f.source=new C(f.source);break}if(f.width===l&&f.source){f.width=f.source.width()}if(f.height===l&&f.source){f.height=f.source.height()}var F=j(this,f);F.sprites=F.sprites||[]},Object,{width:0,height:0,source:null,sprites:l,cols:1,rows:1,type:"grid"},{clip:function(f){return this.clipArray(arguments)},clip_array:function(G){var f=this.sprites(),F=[];for(i=0;i<G.length;i++){F.push([f[G[i]]])}return new a({frames:F})},clip_range:function(f){return this.clipArray(f.to_a())},cut:function(f,I,F,H){var G=new s(q(f)=="object"?{width:r.w,height:r.h,source:{image:this.source().source(),x:r.x,y:r.y,w:r.w,h:r.h}}:{width:F,height:H,source:{image:this.source().source(),x:f,y:I,w:F,h:H}});this._p.sprites.push(G);return G},grid:function(f,I){var H=this._p.sprites=[],F=this.width()/f,G=this.height()/I;r=0,c=0;for(;r<f;r++){for(;c<f;c++){H.push(new s({source:{image:this.source().source(),x:c*F,y:r*G,w:F,h:G}}))}}return this}});var v;x(w=function(f){if(typeof f=="string"){f={text:f}}j(this,f)},E,{text:"",fillStyle:"white",font:null},{begin:function(){v.apply(this,[b]);if(this._p.fillStyle){b.fillStyle=this._p.fillStyle}if(this._p.font){b.font=this._p.font}},paint:u.Text,width:function(){var f=d.getContext("2d");this.begin(f);var F=f.measureText(this.text());return F.width}});v=E.prototype.begin;e=function(f){this.draw=(typeof f=="function")?f:f.code;this.parent=function(){}};e.rotate=function(f){return function(){var F=f.rotation();f.rotation(F<6.1?F+0.1:0)}};var B=function(f){return function(F){return new f(F)}};h.Animate=z;h.Draw=u;h.Property=n;h.Util=k;h.Collision=o;h.Action=e;h.Clip=a;h.DisplayObject=E;h.Image=C;h.Range=A;h.Rect=m;h.Sprite=s;h.Spritesheet=D;h.Text=w;h.Physics=g;h.action=B(e);h.clip=B(a);h.image=B(C);h.range=B(A);h.rect=B(m);h.sprite=B(s);h.spritesheet=B(D);h.text=B(w);h.physics=B(g)})(this,document);