(function(l,n,h){var r="0.1",c,a,q,u,o,s,k,j,m,t,p,g,b,e,d=l.j5g3=new (function(){var x={version:r},w=this,y=function(){return b.getContext("2d")},z=function(){var A=y();w.background.draw(A);w.root.draw(A)},v=function(A){d.Property.define(w.constructor,{canvas:null,fps:100,backgroundStyle:"black",width:640,height:480});e(w,A);if(w._p.canvas===null){w._p.canvas=n.getElementById("screen")}b=w._p.canvas;w.background=new j({fillStyle:w.backgroundStyle(),width:w.width(),height:w.height()});w.root=new a({width:w.width(),height:w.height()});b.width=w.width();b.height=w.height();b.addEventListener("click",w.onClick,false);A.start(d,n)};this._p={};this.run=function(){setInterval(z,this._p.fps)};this.start=function(A){if(typeof(A)=="function"){v({start:A})}else{v(A)}};this.invalidate=function(){}});k=function(v){return function(w){if(w!==h){this._p[v]=w;return this.invalidate()}return this._p[v]}};k.get=function(w,v){return function(x){return w[v]}};k.define=function(x,w){for(var v in w){x.prototype[v]=k(v)}x.properties=w;return x};e=k.extend=function(y,x){y._p=g.clone(y._p);var w=y.constructor.properties,v;if(x){for(v in w){y._p[v]=x[v]||w[v]}}else{for(v in w){y._p[v]=w[v]}}};g={extend:function(w,v){for(var x in v){w[x]=v[x]}return w},inherit:function(w,v){for(var x in v){w[x]=w[x]||v[x]}return w},clone:function(w){var v={};for(var y in w){v[y]=w[y]}return v},Class:function(v,y,x,w){g.extend(v.prototype,new y);k.define(v,x);g.inherit(x,y.properties);g.extend(v.prototype,w);return v},getType:function(w){var v=typeof(w);if(v=="object"){if(w instanceof Array){v="array"}else{if(w._p){v="j5g3"}}}return v}};q=g.Class;o={Image:function(v){v.drawImage(this._p.source,0,0)},Sprite:function(x){var z=this.source(),v=this.width(),y=this.height();x.drawImage(z.image,z.x,z.y,z.w,z.h,0,0,v?v:z.w,y?y:z.h)},Container:function(w){var x=this.frame();for(var v in x){x[v].draw(w)}}};q(u=function(v){this._p={};e(this,v);this._dirty=true},Object,{source:null,parent:null,x:0,y:0,width:null,height:null,rotation:0,scaleX:1,scaleY:1,alpha:1},{begin:function(v){v.save();v.globalAlpha*=this.alpha();v.translate(this.x(),this.y());v.scale(this.scaleX(),this.scaleY());v.rotate(this.rotation())},end:function(v){v.restore()},draw:function(v){this.begin(v);this.paint(v);this.end(v)},invalidate:function(){this._dirty=true},isDirty:function(){return this._dirty},align:function(w,v){switch(w){case"center":this.x(v.width()/2);break;case"left":this.x(0);break;case"right":this.x(v.width()-this.width());break;case"middle":this.y(v.height()/2);break}return this},collidesWith:function(A){var y=this.x()-A.x();var x=this.y()-A.y();var v=this.width();if(Math.abs(y)>v||Math.abs(x)>v){return false}var z=y*y+x*x;if(z>v*v){return false}return true},pos:function(v,w){this._p.x=v;this._p.y=w;this.invalidate();return this}});q(a=function(v){e(this,v);if(!this._p.frames){this._p.frames=[[]]}this._frame=0;this._playing=true},u,{frames:null},{frame:function(){f=this.frames()[this._frame];if(this._playing){this.nextFrame()}return f},totalFrames:function(){return this.frames().length},currentFrame:function(){return _frame},nextFrame:function(){this._frame=(this._frame<this.totalFrames()-1)?this._frame+1:0},paint:o.Container,stop:function(){this._playing=false},play:function(){this._playing=true},add:function(w){switch(g.getType(w)){case"function":w=new c(w);break;case"string":w=new s({source:w});break;case"object":w=new s(w);break;case"array":for(var v in w){this.add(w[v])}return this}w.parent(this);this.frames()[this._frame].push(w);return this},gotoFrame:function(v){this._frame=v;return this},gotoAndPlay:function(v){this.gotoFrame(v);this.play();return this},gotoAndStop:function(v){this.gotoFrame(v);this.stop();return this},alignChildren:function(x){var w=this.frame();for(var v in w){if(w[v].align){w[v].align(x,this)}}return this},animateTo:function(x,w,z){var y={};if(z===h){z=Animate.Easing.None}for(var v in x){y[v]=x}return function(){z(y,x,this._iframe)}}});q(s=function(v){if(typeof v=="string"){v={source:v}}e(this,v);if(this._p.source){this.source(this._p.source)}},u,{},{paint:o.Image,source:function(v){if(v){if(typeof(v)=="string"){this._p.source=new l.Image;this._p.source.src=v}else{this._p.source=v}if(this._p.width===null){this._p.width=this._p.source.width}if(this._p.height===null){this._p.height=this._p.source.height}this.invalidate();return this}return this._p.source}});q(j=function(v){e(this,v)},u,{fillStyle:null},{paint:function(v){if(this._p.fillStyle){v.fillStyle=this._p.fillStyle}v.fillRect(this._p.x,this._p.y,this._p.width,this._p.height)}});q(m=function(v){e(this,v)},u,{},{paint:o.Sprite});q(t=function(v){if(typeof v=="string"){v={source:new s(v)}}if(typeof v.source=="string"){v.source=new s(v.source)}if(v.width===h&&v.source){v.width=v.source.width()}if(v.height===h&&v.source){v.height=v.source.height()}k.extend(this,v);this._p=d.extend({cols:1,rows:1,type:"grid"},v)},Object,{width:0,height:0,source:null,sprites:0},{clip:function(){var v=this.sprites(),w=[];for(i=0;i<arguments.length;i++){w.push([v[arguments[i]]])}return new a({frames:w})},grid:function(v,E){var B=[],z=this.width()/v,A=this.height()/E;for(var C=0;C<v;C++){for(var D=0;D<v;D++){B.push(new m({source:{image:this.source().source(),x:D*z,y:C*A,w:z,h:A}}))}}this._p.sprites=B;return this}});q(p=function(v){if(typeof v=="string"){v={text:v}}e(this,v)},u,{text:"",fillStyle:"white",font:null},{_applyContext:function(v){if(this._p.fillStyle){v.fillStyle=this._p.fillStyle}if(this._p.font){v.font=this._p.font}},paint:function(v){this._applyContext(v);v.fillText(this.text(),0,0)},width:function(){var v=b.getContext("2d");this._applyContext(v);var w=v.measureText(this.text());return w.width}});c=function(v){this.draw=(typeof v=="function")?v:v.code;this.parent=function(){}};c.rotate=function(v){return function(){var w=v.rotation();v.rotation(w<6.1?w+0.1:0)}};d.Action=c;d.Clip=a;d.DisplayObject=u;d.Draw=o;d.Image=s;d.Property=k;d.Rect=j;d.Sprite=m;d.Spritesheet=t;d.Text=p;d.Util=g})(this,document);