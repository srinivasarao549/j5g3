(function(o,s,l){var x="0.1",e,y,a,w,D,t,B,g,n,z,m,q,C,v,k,d,j,p,b,h=o.j5g3=new (function(){var F={version:x},E=this,G=function(){return d.getContext("2d")},f=function(H){h.Property.define(E.constructor,{canvas:null,backgroundStyle:"black",width:640,height:480});j(E,H);if(E._p.canvas===null){E._p.canvas=h.id("screen")}d=E._p.canvas;E.background=new m({fillStyle:E.backgroundStyle(),width:E.width(),height:E.height()});E.root=new a({width:E.width(),height:E.height()});d.width=E.width();d.height=E.height();d.addEventListener("click",E.onClick,false);H.start(h,s)};this.run=function(){setInterval(this.gameLoop,this._p.fps)};this.gameLoop=function(){b=G();E.background.draw();E.root.draw()};this.fps=function(H){if(H===l){return 1000/this._p.fps}this._p.fps=1000/H;return this};this.start=function(H){f(typeof(H)=="function"?{start:H}:H)};this.invalidate=function(){return this};this.id=function(H){return s.getElementById(H)}});y={Easing:{None:function(){},RegularOut:function(){return 0}}};n=function(f){return function(E){return E===l?this._p[f]:(this._p[f]=E,this.invalidate())}};n.get=function(E,f){return function(F){return E[f]}};n.define=function(F,E){for(var f in E){F.prototype[f]=n(f)}F.properties=E;return F};j=n.extend=function(G,F){G._p={};var E=G.constructor.properties,f;if(F){for(f in E){G._p[f]=F[f]||E[f]}}else{for(f in E){G._p[f]=E[f]}}return G._p};k={extend:function(E,f){for(var F in f){E[F]=f[F]}return E},inherit:function(E,f){for(var F in f){E[F]=E[F]||f[F]}return E},clone:function(E){var f={};for(var F in E){f[F]=E[F]}return f},Class:function(f,G,F,E){k.extend(f.prototype,new G);n.define(f,F);k.inherit(F,G.properties);k.extend(f.prototype,E);return f}};w=k.Class;p=k.getType=function(E){var f=typeof(E);if(f=="object"){if(E instanceof Array){return"array"}if(E instanceof HTMLElement){return"DOM"}if(E._p){return"j5g3"}}return f};t={Image:function(){b.drawImage(this._p.source,0,0)},Sprite:function(){var F=this.source(),f=this.width(),E=this.height();b.drawImage(F.image,F.x,F.y,F.w,F.h,0,0,f?f:F.w,E?E:F.h)},Container:function(){var E=this.frame();for(var f in E){E[f].draw(b)}},Text:function(){b.fillText(this.text(),0,0)}};w(D=function(f){this._p={};j(this,f);this._dirty=true},Object,{source:null,parent:null,x:0,y:0,width:null,height:null,rotation:0,scaleX:1,scaleY:1,alpha:1},{begin:function(){b.save();b.globalAlpha*=this.alpha();b.translate(this.x(),this.y());b.scale(this.scaleX(),this.scaleY());b.rotate(this.rotation())},end:function(){b.restore()},draw:function(){this.begin();this.paint();this.end()},invalidate:function(){this._dirty=true;return this},isDirty:function(){return this._dirty},align:function(E,f){switch(E){case"center":this.x(f.width()/2);break;case"left":this.x(0);break;case"right":this.x(f.width()-this.width());break;case"middle":this.y(f.height()/2);break}return this},collidesWith:function(H){var F=this.x()-H.x();var E=this.y()-H.y();var f=this.width();if(Math.abs(F)>f||Math.abs(E)>f){return false}var G=F*F+E*E;if(G>f*f){return false}return true},pos:function(f,E){this._p.x=f;this._p.y=E;this.invalidate();return this}});w(a=function(f){j(this,f);if(!this._p.frames){this._p.frames=[[]]}this._frame=0;this._playing=true},D,{frames:null},{frame:function(){A=this.frames()[this._frame];if(this._playing){this.nextFrame()}return A},totalFrames:function(){return this.frames().length},currentFrame:function(){return _frame},nextFrame:function(){this._frame=(this._frame<this.totalFrames()-1)?this._frame+1:0},paint:t.Container,stop:function(){this._playing=false},play:function(){this._playing=true},add:function(F){switch(p(F)){case"function":F=new e(F);break;case"string":F=new B({source:F});break;case"object":F=new B(F);break;case"array":for(var E in F){this.add(F[E])}return this}if(F.parent){F.parent(this)}var G=this.frames();G[G.length-1].push(F);return this},gotoFrame:function(f){this._frame=f;return this},gotoAndPlay:function(f){this.gotoFrame(f);this.play();return this},gotoAndStop:function(f){this.gotoFrame(f);this.stop();return this},alignChildren:function(F){var E=this.frame();for(var f in E){if(E[f].align){E[f].align(F,this)}}return this},animateTo:function(F,E,H){var G={};if(H===l){H=y.Easing.None}for(var f in F){G[f]=F}return function(){H(G,F,this._iframe)}}});w(B=function(f){switch(p(f)){case"string":case"DOM":f={source:f};break}j(this,f);if(this._p.source){this.source(this._p.source)}},D,{},{paint:t.Image,source:function(f){if(f){if(typeof(f)=="string"){this._p.source=new o.Image;this._p.source.src=f}else{this._p.source=f}if(this._p.width===null){this._p.width=this._p.source.width}if(this._p.height===null){this._p.height=this._p.source.height}this.invalidate();return this}return this._p.source}});w(z=function(E,f){if(typeof E!="object"){E={start:E,end:f}}j(this,E)},Object,{start:0,end:0},{to_a:function(){var F=this._p,E=F.start,f=[];for(;E<F.end;E++){f.push(E)}return f}});w(m=function(f){j(this,f)},D,{fillStyle:null},{paint:function(){if(this._p.fillStyle){b.fillStyle=this._p.fillStyle}b.fillRect(this._p.x,this._p.y,this._p.width,this._p.height)}});w(g=function(f){j(this,f)},Object,{obj:null,v:null},{draw:function(){var E=this._p.obj,f=this._p.v;E.x(E.x()+f[0]);E.y(E.y()+f[1])}});w(q=function(f){j(this,f)},D,{},{paint:t.Sprite});w(C=function(f){switch(p(f)){case"string":case"DOM":case"j5g3":f={source:f}}switch(p(f.source)){case"string":case"DOM":f.source=new B(f.source);break}if(f.width===l&&f.source){f.width=f.source.width()}if(f.height===l&&f.source){f.height=f.source.height()}var E=j(this,f);E.sprites=E.sprites||[]},Object,{width:0,height:0,source:null,sprites:l,cols:1,rows:1,type:"grid"},{clip:function(f){return this.clipArray(arguments)},clip_array:function(F){var f=this.sprites(),E=[];for(i=0;i<F.length;i++){E.push([f[F[i]]])}return new a({frames:E})},clip_range:function(f){return this.clipArray(f.to_a())},cut:function(E){var f=new q(p(E)=="array"?{source:{image:this.source().source(),x:E[0],y:E[1],w:E[2],h:E[3]}}:{source:{image:this.source().source(),x:E.x,y:E.y,w:E.w,h:E.h}});this._p.sprites.push(f);return f},grid:function(f,H){var G=this._p.sprites=[],E=this.width()/f,F=this.height()/H;r=0,c=0;for(;r<f;r++){for(;c<f;c++){G.push(new q({source:{image:this.source().source(),x:c*E,y:r*F,w:E,h:F}}))}}return this}});var u;w(v=function(f){if(typeof f=="string"){f={text:f}}j(this,f)},D,{text:"",fillStyle:"white",font:null},{begin:function(){u.apply(this,[b]);if(this._p.fillStyle){b.fillStyle=this._p.fillStyle}if(this._p.font){b.font=this._p.font}},paint:t.Text,width:function(){var f=d.getContext("2d");this.begin(f);var E=f.measureText(this.text());return E.width}});u=D.prototype.begin;e=function(f){this.draw=(typeof f=="function")?f:f.code;this.parent=function(){}};e.rotate=function(f){return function(){var E=f.rotation();f.rotation(E<6.1?E+0.1:0)}};var A=function(f){return function(E){return new f(E)}};h.Animate=y;h.Draw=t;h.Property=n;h.Util=k;h.Action=e;h.Clip=a;h.DisplayObject=D;h.Image=B;h.Range=z;h.Rect=m;h.Sprite=q;h.Spritesheet=C;h.Text=v;h.Physics=g;h.action=A(e);h.clip=A(a);h.image=A(B);h.range=A(z);h.rect=A(m);h.sprite=A(q);h.spritesheet=A(C);h.text=A(v);h.physics=A(g)})(this,document);