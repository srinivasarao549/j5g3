(function(l,n,h){var s="0.1",c,a,r,v,o,t,k,j,m,u,q,g,b,e,d=l.j5g3=new (function(){var y={version:s},x=this,z=function(){return b.getContext("2d")},w=function(A){d.Property.define(x.constructor,{canvas:null,fps:100,backgroundStyle:"black",width:640,height:480});e(x,A);if(x._p.canvas===null){x._p.canvas=n.getElementById("screen")}b=x._p.canvas;x.background=new j({fillStyle:x.backgroundStyle(),width:x.width(),height:x.height()});x.root=new a({width:x.width(),height:x.height()});b.width=x.width();b.height=x.height();b.addEventListener("click",x.onClick,false);A.start(d,n)};this._p={};this.run=function(){setInterval(this.gameLoop,this._p.fps)};this.gameLoop=function(){var A=z();x.background.draw(A);x.root.draw(A)};this.start=function(A){w(typeof(A)=="function"?{start:A}:A)};this.invalidate=function(){}});k=function(w){return function(x){if(x!==h){this._p[w]=x;return this.invalidate()}return this._p[w]}};k.get=function(x,w){return function(y){return x[w]}};k.define=function(y,x){for(var w in x){y.prototype[w]=k(w)}y.properties=x;return y};e=k.extend=function(z,y){z._p=g.clone(z._p);var x=z.constructor.properties,w;if(y){for(w in x){z._p[w]=y[w]||x[w]}}else{for(w in x){z._p[w]=x[w]}}};g={extend:function(x,w){for(var y in w){x[y]=w[y]}return x},inherit:function(x,w){for(var y in w){x[y]=x[y]||w[y]}return x},clone:function(y){var w={};for(var z in y){w[z]=y[z]}return w},Class:function(w,z,y,x){g.extend(w.prototype,new z);k.define(w,y);g.inherit(y,z.properties);g.extend(w.prototype,x);return w},getType:function(x){var w=typeof(x);if(w=="object"){if(x instanceof Array){w="array"}else{if(x._p){w="j5g3"}}}return w}};r=g.Class;o={Image:function(w){w.drawImage(this._p.source,0,0)},Sprite:function(y){var A=this.source(),x=this.width(),z=this.height();y.drawImage(A.image,A.x,A.y,A.w,A.h,0,0,x?x:A.w,z?z:A.h)},Container:function(x){var y=this.frame();for(var w in y){y[w].draw(x)}},Text:function(w){w.fillText(this.text(),0,0)}};r(v=function(w){this._p={};e(this,w);this._dirty=true},Object,{source:null,parent:null,x:0,y:0,width:null,height:null,rotation:0,scaleX:1,scaleY:1,alpha:1},{begin:function(w){w.save();w.globalAlpha*=this.alpha();w.translate(this.x(),this.y());w.scale(this.scaleX(),this.scaleY());w.rotate(this.rotation())},end:function(w){w.restore()},draw:function(w){this.begin(w);this.paint(w);this.end(w)},invalidate:function(){this._dirty=true},isDirty:function(){return this._dirty},align:function(x,w){switch(x){case"center":this.x(w.width()/2);break;case"left":this.x(0);break;case"right":this.x(w.width()-this.width());break;case"middle":this.y(w.height()/2);break}return this},collidesWith:function(B){var z=this.x()-B.x();var y=this.y()-B.y();var x=this.width();if(Math.abs(z)>x||Math.abs(y)>x){return false}var A=z*z+y*y;if(A>x*x){return false}return true},pos:function(w,z){this._p.x=w;this._p.y=z;this.invalidate();return this}});r(a=function(w){e(this,w);if(!this._p.frames){this._p.frames=[[]]}this._frame=0;this._playing=true},v,{frames:null},{frame:function(){f=this.frames()[this._frame];if(this._playing){this.nextFrame()}return f},totalFrames:function(){return this.frames().length},currentFrame:function(){return _frame},nextFrame:function(){this._frame=(this._frame<this.totalFrames()-1)?this._frame+1:0},paint:o.Container,stop:function(){this._playing=false},play:function(){this._playing=true},add:function(x){switch(g.getType(x)){case"function":x=new c(x);break;case"string":x=new t({source:x});break;case"object":x=new t(x);break;case"array":for(var w in x){this.add(x[w])}return this}x.parent(this);this.frames()[this._frame].push(x);return this},gotoFrame:function(w){this._frame=w;return this},gotoAndPlay:function(w){this.gotoFrame(w);this.play();return this},gotoAndStop:function(w){this.gotoFrame(w);this.stop();return this},alignChildren:function(y){var x=this.frame();for(var w in x){if(x[w].align){x[w].align(y,this)}}return this},animateTo:function(y,x,A){var z={};if(A===h){A=Animate.Easing.None}for(var w in y){z[w]=y}return function(){A(z,y,this._iframe)}}});r(t=function(w){if(typeof w=="string"){w={source:w}}e(this,w);if(this._p.source){this.source(this._p.source)}},v,{},{paint:o.Image,source:function(w){if(w){if(typeof(w)=="string"){this._p.source=new l.Image;this._p.source.src=w}else{this._p.source=w}if(this._p.width===null){this._p.width=this._p.source.width}if(this._p.height===null){this._p.height=this._p.source.height}this.invalidate();return this}return this._p.source}});r(j=function(w){e(this,w)},v,{fillStyle:null},{paint:function(w){if(this._p.fillStyle){w.fillStyle=this._p.fillStyle}w.fillRect(this._p.x,this._p.y,this._p.width,this._p.height)}});r(m=function(w){e(this,w)},v,{},{paint:o.Sprite});r(u=function(w){if(typeof w=="string"){w={source:new t(w)}}if(typeof w.source=="string"){w.source=new t(w.source)}if(w.width===h&&w.source){w.width=w.source.width()}if(w.height===h&&w.source){w.height=w.source.height()}k.extend(this,w);this._p=d.extend({cols:1,rows:1,type:"grid"},w)},Object,{width:0,height:0,source:null,sprites:0},{clip:function(){var w=this.sprites(),x=[];for(i=0;i<arguments.length;i++){x.push([w[arguments[i]]])}return new a({frames:x})},grid:function(z,F){var C=[],A=this.width()/z,B=this.height()/F;for(var D=0;D<z;D++){for(var E=0;E<z;E++){C.push(new m({source:{image:this.source().source(),x:E*A,y:D*B,w:A,h:B}}))}}this._p.sprites=C;return this}});var p;r(q=function(w){if(typeof w=="string"){w={text:w}}e(this,w)},v,{text:"",fillStyle:"white",font:null},{begin:function(w){p.apply(this,[w]);if(this._p.fillStyle){w.fillStyle=this._p.fillStyle}if(this._p.font){w.font=this._p.font}},paint:o.Text,width:function(){var w=b.getContext("2d");this.begin(w);var x=w.measureText(this.text());return x.width}});p=v.prototype.begin;c=function(w){this.draw=(typeof w=="function")?w:w.code;this.parent=function(){}};c.rotate=function(w){return function(){var x=w.rotation();w.rotation(x<6.1?x+0.1:0)}};d.Action=c;d.Clip=a;d.DisplayObject=v;d.Draw=o;d.Image=t;d.Property=k;d.Rect=j;d.Sprite=m;d.Spritesheet=u;d.Text=q;d.Util=g})(this,document);