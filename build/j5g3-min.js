(function(l,n,h){var s="0.1",c,t,a,r,w,o,u,k,j,m,v,q,g,b,e,d=l.j5g3=new (function(){var z={version:s},y=this,A=function(){return b.getContext("2d")},x=function(B){d.Property.define(y.constructor,{canvas:null,fps:100,backgroundStyle:"black",width:640,height:480});e(y,B);if(y._p.canvas===null){y._p.canvas=n.getElementById("screen")}b=y._p.canvas;y.background=new j({fillStyle:y.backgroundStyle(),width:y.width(),height:y.height()});y.root=new a({width:y.width(),height:y.height()});b.width=y.width();b.height=y.height();b.addEventListener("click",y.onClick,false);B.start(d,n)};this._p={};this.run=function(){setInterval(this.gameLoop,this._p.fps)};this.gameLoop=function(){var B=A();y.background.draw(B);y.root.draw(B)};this.start=function(B){x(typeof(B)=="function"?{start:B}:B)};this.invalidate=function(){return this}});t={Easing:{None:function(){},RegularOut:function(){return 0}}};k=function(x){return function(y){if(y!==h){this._p[x]=y;return this.invalidate()}return this._p[x]}};k.get=function(y,x){return function(z){return y[x]}};k.define=function(z,y){for(var x in y){z.prototype[x]=k(x)}z.properties=y;return z};e=k.extend=function(A,z){A._p=g.clone(A._p);var y=A.constructor.properties,x;if(z){for(x in y){A._p[x]=z[x]||y[x]}}else{for(x in y){A._p[x]=y[x]}}};g={extend:function(y,x){for(var z in x){y[z]=x[z]}return y},inherit:function(y,x){for(var z in x){y[z]=y[z]||x[z]}return y},clone:function(z){var y={};for(var A in z){y[A]=z[A]}return y},Class:function(x,A,z,y){g.extend(x.prototype,new A);k.define(x,z);g.inherit(z,A.properties);g.extend(x.prototype,y);return x},getType:function(y){var x=typeof(y);if(x=="object"){if(y instanceof Array){x="array"}else{if(y._p){x="j5g3"}}}return x}};r=g.Class;o={Image:function(x){x.drawImage(this._p.source,0,0)},Sprite:function(y){var A=this.source(),x=this.width(),z=this.height();y.drawImage(A.image,A.x,A.y,A.w,A.h,0,0,x?x:A.w,z?z:A.h)},Container:function(y){var z=this.frame();for(var x in z){z[x].draw(y)}},Text:function(x){x.fillText(this.text(),0,0)}};r(w=function(x){this._p={};e(this,x);this._dirty=true},Object,{source:null,parent:null,x:0,y:0,width:null,height:null,rotation:0,scaleX:1,scaleY:1,alpha:1},{begin:function(x){x.save();x.globalAlpha*=this.alpha();x.translate(this.x(),this.y());x.scale(this.scaleX(),this.scaleY());x.rotate(this.rotation())},end:function(x){x.restore()},draw:function(x){this.begin(x);this.paint(x);this.end(x)},invalidate:function(){this._dirty=true;return this},isDirty:function(){return this._dirty},align:function(y,x){switch(y){case"center":this.x(x.width()/2);break;case"left":this.x(0);break;case"right":this.x(x.width()-this.width());break;case"middle":this.y(x.height()/2);break}return this},collidesWith:function(B){var z=this.x()-B.x();var y=this.y()-B.y();var x=this.width();if(Math.abs(z)>x||Math.abs(y)>x){return false}var A=z*z+y*y;if(A>x*x){return false}return true},pos:function(z,A){this._p.x=z;this._p.y=A;this.invalidate();return this}});r(a=function(x){e(this,x);if(!this._p.frames){this._p.frames=[[]]}this._frame=0;this._playing=true},w,{frames:null},{frame:function(){f=this.frames()[this._frame];if(this._playing){this.nextFrame()}return f},totalFrames:function(){return this.frames().length},currentFrame:function(){return _frame},nextFrame:function(){this._frame=(this._frame<this.totalFrames()-1)?this._frame+1:0},paint:o.Container,stop:function(){this._playing=false},play:function(){this._playing=true},add:function(y){switch(g.getType(y)){case"function":y=new c(y);break;case"string":y=new u({source:y});break;case"object":y=new u(y);break;case"array":for(var x in y){this.add(y[x])}return this}y.parent(this);this.frames()[this._frame].push(y);return this},gotoFrame:function(x){this._frame=x;return this},gotoAndPlay:function(x){this.gotoFrame(x);this.play();return this},gotoAndStop:function(x){this.gotoFrame(x);this.stop();return this},alignChildren:function(z){var y=this.frame();for(var x in y){if(y[x].align){y[x].align(z,this)}}return this},animateTo:function(z,y,B){var A={};if(B===h){B=t.Easing.None}for(var x in z){A[x]=z}return function(){B(A,z,this._iframe)}}});r(u=function(x){if(typeof x=="string"){x={source:x}}e(this,x);if(this._p.source){this.source(this._p.source)}},w,{},{paint:o.Image,source:function(x){if(x){if(typeof(x)=="string"){this._p.source=new l.Image;this._p.source.src=x}else{this._p.source=x}if(this._p.width===null){this._p.width=this._p.source.width}if(this._p.height===null){this._p.height=this._p.source.height}this.invalidate();return this}return this._p.source}});r(j=function(x){e(this,x)},w,{fillStyle:null},{paint:function(x){if(this._p.fillStyle){x.fillStyle=this._p.fillStyle}x.fillRect(this._p.x,this._p.y,this._p.width,this._p.height)}});r(m=function(x){e(this,x)},w,{},{paint:o.Sprite});r(v=function(x){if(typeof x=="string"){x={source:new u(x)}}if(typeof x.source=="string"){x.source=new u(x.source)}if(x.width===h&&x.source){x.width=x.source.width()}if(x.height===h&&x.source){x.height=x.source.height()}e(this,x)},Object,{width:0,height:0,source:null,sprites:0,cols:1,rows:1,type:"grid"},{clip:function(){var x=this.sprites(),y=[];for(i=0;i<arguments.length;i++){y.push([x[arguments[i]]])}return new a({frames:y})},grid:function(z,F){var C=[],A=this.width()/z,B=this.height()/F;for(var D=0;D<z;D++){for(var E=0;E<z;E++){C.push(new m({source:{image:this.source().source(),x:E*A,y:D*B,w:A,h:B}}))}}this._p.sprites=C;return this}});var p;r(q=function(x){if(typeof x=="string"){x={text:x}}e(this,x)},w,{text:"",fillStyle:"white",font:null},{begin:function(x){p.apply(this,[x]);if(this._p.fillStyle){x.fillStyle=this._p.fillStyle}if(this._p.font){x.font=this._p.font}},paint:o.Text,width:function(){var x=b.getContext("2d");this.begin(x);var y=x.measureText(this.text());return y.width}});p=w.prototype.begin;c=function(x){this.draw=(typeof x=="function")?x:x.code;this.parent=function(){}};c.rotate=function(x){return function(){var y=x.rotation();x.rotation(y<6.1?y+0.1:0)}};d.Action=c;d.Animate=t;d.Clip=a;d.DisplayObject=w;d.Draw=o;d.Image=u;d.Property=k;d.Rect=j;d.Sprite=m;d.Spritesheet=v;d.Text=q;d.Util=g})(this,document);