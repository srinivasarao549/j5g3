(function(l,o,h){var t="0.1",c,u,a,s,y,p,w,k,v,j,n,x,r,g,b,e,m,d=l.j5g3=new (function(){var B={version:t},A=this,C=function(){return b.getContext("2d")},z=function(D){d.Property.define(A.constructor,{canvas:null,fps:100,backgroundStyle:"black",width:640,height:480});e(A,D);if(A._p.canvas===null){A._p.canvas=o.getElementById("screen")}b=A._p.canvas;A.background=new j({fillStyle:A.backgroundStyle(),width:A.width(),height:A.height()});A.root=new a({width:A.width(),height:A.height()});b.width=A.width();b.height=A.height();b.addEventListener("click",A.onClick,false);D.start(d,o)};this._p={};this.run=function(){setInterval(this.gameLoop,this._p.fps)};this.gameLoop=function(){var D=C();A.background.draw(D);A.root.draw(D)};this.start=function(D){z(typeof(D)=="function"?{start:D}:D)};this.invalidate=function(){return this};this.id=function(D){return o.getElementById(D)}});u={Easing:{None:function(){},RegularOut:function(){return 0}}};k=function(z){return function(A){if(A!==h){this._p[z]=A;return this.invalidate()}return this._p[z]}};k.get=function(A,z){return function(B){return A[z]}};k.define=function(B,A){for(var z in A){B.prototype[z]=k(z)}B.properties=A;return B};e=k.extend=function(C,B){C._p={};var A=C.constructor.properties,z;if(B){for(z in A){C._p[z]=B[z]||A[z]}}else{for(z in A){C._p[z]=A[z]}}};g={extend:function(A,z){for(var B in z){A[B]=z[B]}return A},inherit:function(A,z){for(var B in z){A[B]=A[B]||z[B]}return A},clone:function(A){var z={};for(var B in A){z[B]=A[B]}return z},Class:function(z,C,B,A){g.extend(z.prototype,new C);k.define(z,B);g.inherit(B,C.properties);g.extend(z.prototype,A);return z}};s=g.Class;m=g.getType=function(A){var z=typeof(A);if(z=="object"){if(A instanceof Array){return"array"}if(A instanceof HTMLElement){return"DOM"}if(A._p){return"j5g3"}}return z};p={Image:function(z){z.drawImage(this._p.source,0,0)},Sprite:function(A){var C=this.source(),z=this.width(),B=this.height();A.drawImage(C.image,C.x,C.y,C.w,C.h,0,0,z?z:C.w,B?B:C.h)},Container:function(A){var B=this.frame();for(var z in B){B[z].draw(A)}},Text:function(z){z.fillText(this.text(),0,0)}};s(y=function(z){this._p={};e(this,z);this._dirty=true},Object,{source:null,parent:null,x:0,y:0,width:null,height:null,rotation:0,scaleX:1,scaleY:1,alpha:1},{begin:function(z){z.save();z.globalAlpha*=this.alpha();z.translate(this.x(),this.y());z.scale(this.scaleX(),this.scaleY());z.rotate(this.rotation())},end:function(z){z.restore()},draw:function(z){this.begin(z);this.paint(z);this.end(z)},invalidate:function(){this._dirty=true;return this},isDirty:function(){return this._dirty},align:function(A,z){switch(A){case"center":this.x(z.width()/2);break;case"left":this.x(0);break;case"right":this.x(z.width()-this.width());break;case"middle":this.y(z.height()/2);break}return this},collidesWith:function(D){var B=this.x()-D.x();var A=this.y()-D.y();var z=this.width();if(Math.abs(B)>z||Math.abs(A)>z){return false}var C=B*B+A*A;if(C>z*z){return false}return true},pos:function(z,A){this._p.x=z;this._p.y=A;this.invalidate();return this}});s(a=function(z){e(this,z);if(!this._p.frames){this._p.frames=[[]]}this._frame=0;this._playing=true},y,{frames:null},{frame:function(){f=this.frames()[this._frame];if(this._playing){this.nextFrame()}return f},totalFrames:function(){return this.frames().length},currentFrame:function(){return _frame},nextFrame:function(){this._frame=(this._frame<this.totalFrames()-1)?this._frame+1:0},paint:p.Container,stop:function(){this._playing=false},play:function(){this._playing=true},add:function(A){switch(m(A)){case"function":A=new c(A);break;case"string":A=new w({source:A});break;case"object":A=new w(A);break;case"array":for(var z in A){this.add(A[z])}return this}A.parent(this);var B=this.frames();B[B.length-1].push(A);return this},gotoFrame:function(z){this._frame=z;return this},gotoAndPlay:function(z){this.gotoFrame(z);this.play();return this},gotoAndStop:function(z){this.gotoFrame(z);this.stop();return this},alignChildren:function(B){var A=this.frame();for(var z in A){if(A[z].align){A[z].align(B,this)}}return this},animateTo:function(B,A,D){var C={};if(D===h){D=u.Easing.None}for(var z in B){C[z]=B}return function(){D(C,B,this._iframe)}}});s(w=function(z){switch(m(z)){case"string":case"DOM":z={source:z};break}e(this,z);if(this._p.source){this.source(this._p.source)}},y,{},{paint:p.Image,source:function(z){if(z){if(typeof(z)=="string"){this._p.source=new l.Image;this._p.source.src=z}else{this._p.source=z}if(this._p.width===null){this._p.width=this._p.source.width}if(this._p.height===null){this._p.height=this._p.source.height}this.invalidate();return this}return this._p.source}});s(v=function(A,z){if(typeof A!="object"){A={start:A,end:z}}e(this,A)},Object,{start:0,end:0},{to_a:function(){var B=this._p,A=B.start,z=[];for(;A<B.end;A++){z.push(A)}return z}});s(j=function(z){e(this,z)},y,{fillStyle:null},{paint:function(z){if(this._p.fillStyle){z.fillStyle=this._p.fillStyle}z.fillRect(this._p.x,this._p.y,this._p.width,this._p.height)}});s(n=function(z){e(this,z)},y,{},{paint:p.Sprite});s(x=function(z){switch(m(z)){case"string":case"DOM":case"j5g3":z={source:z}}switch(m(z.source)){case"string":case"DOM":z.source=new w(z.source);break}if(z.width===h&&z.source){z.width=z.source.width()}if(z.height===h&&z.source){z.height=z.source.height()}e(this,z)},Object,{width:0,height:0,source:null,sprites:0,cols:1,rows:1,type:"grid"},{clip:function(){return this.clipArray(arguments)},clipArray:function(B){var z=this.sprites(),A=[];for(i=0;i<B.length;i++){A.push([z[B[i]]])}return new a({frames:A})},clipRange:function(z){return this.clipArray(z.to_a())},grid:function(z,F){var C=[],A=this.width()/z,B=this.height()/F;for(var D=0;D<z;D++){for(var E=0;E<z;E++){C.push(new n({source:{image:this.source().source(),x:E*A,y:D*B,w:A,h:B}}))}}this._p.sprites=C;return this}});var q;s(r=function(z){if(typeof z=="string"){z={text:z}}e(this,z)},y,{text:"",fillStyle:"white",font:null},{begin:function(z){q.apply(this,[z]);if(this._p.fillStyle){z.fillStyle=this._p.fillStyle}if(this._p.font){z.font=this._p.font}},paint:p.Text,width:function(){var z=b.getContext("2d");this.begin(z);var A=z.measureText(this.text());return A.width}});q=y.prototype.begin;c=function(z){this.draw=(typeof z=="function")?z:z.code;this.parent=function(){}};c.rotate=function(z){return function(){var A=z.rotation();z.rotation(A<6.1?A+0.1:0)}};d.Action=c;d.Animate=u;d.Clip=a;d.DisplayObject=y;d.Draw=p;d.Image=w;d.Property=k;d.Range=v;d.Rect=j;d.Sprite=n;d.Spritesheet=x;d.Text=r;d.Util=g})(this,document);